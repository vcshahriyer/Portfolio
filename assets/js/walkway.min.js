(function(a,b){if(typeof define==="function"&&define.amd){define(b)}else{if(typeof exports==="object"){module.exports=b()}else{a.Walkway=b()}}}(this,function factory(g){var a=0;window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;window.cancelAnimationFrame=window.cancelAnimationFrame||window.mozCancelAnimationFrame;if(!window.requestAnimationFrame){window.requestAnimationFrame=function(r,o){var n=new Date().getTime();var p=Math.max(0,16-(n-a));var q=window.setTimeout(function(){r(n+p)},p);a=n+p;return q}}if(!window.cancelAnimationFrame){window.cancelAnimationFrame=function(n){clearTimeout(n)}}var k={linear:function(n){return n},easeInQuad:function(n){return n*n},easeOutQuad:function(n){return n*(2-n)},easeInOutQuad:function(n){return n<0.5?2*n*n:-1+(4-2*n)*n},easeInCubic:function(n){return n*n*n},easeOutCubic:function(n){return(--n)*n*n+1},easeInOutCubic:function(n){return n<0.5?4*n*n*n:(n-1)*(2*n-2)*(2*n-2)+1},easeInQuart:function(n){return n*n*n*n},easeOutQuart:function(n){return 1-(--n)*n*n*n},easeInOutQuart:function(n){return n<0.5?8*n*n*n*n:1-8*(--n)*n*n*n},easeInQuint:function(n){return n*n*n*n*n},easeOutQuint:function(n){return 1+(--n)*n*n*n*n},easeInOutQuint:function(n){return n<0.5?16*n*n*n*n*n:1+16*(--n)*n*n*n*n}};function b(o){var n=["path","line","polyline"];var p=n.reduce(function(q,r){return q+o+" "+r+", "},"");return p.slice(0,-2)}var f=[];var m=[];document.addEventListener("visibilitychange",function(){if(!document.hidden){return}for(var q=0,p=m.length;q<p;q++){m[q].cancel()}for(var o=0,n=f.length;o<n;o++){f[o].complete()}},false);function i(n){if(!(this instanceof i)){return new i(n)}if(typeof n==="string"){n={selector:n}}if(!n.selector){return this.error("A selector needs to be specified")}this.opts=n;this.selector=n.selector;this.duration=n.duration||500;this.easing=(typeof n.easing==="function")?n.easing:k[n.easing]||k.easeInOutCubic;this.id=false;this.elements=this.getElements();this.callback=n.callback;this.setInitialStyles();f=f.concat(this.elements);m.push(this)}i.prototype={constructor:i,error:function(n){console.error("Walkway error: "+n)},getElements:function(){var o=this;var n=b(this.selector);var p=document.querySelectorAll(n);p=Array.prototype.slice.call(p);return p.map(function(q){if(q.tagName==="path"){return new e(q,o.duration,o.easing)}else{if(q.tagName==="line"){return new d(q,o.duration,o.easing)}else{if(q.tagName==="polyline"){return new h(q,o.duration,o.easing)}}}})},setInitialStyles:function(){this.elements.forEach(function(o){o.el.style.strokeDasharray=o.length+" "+o.length;o.el.style.strokeDashoffset=o.length})},draw:function(r){var o=this.elements.length;var q=this.elements.filter(function(s){return s.done}).length===o;var p=null;var n=false;this.callback=r||this.callback;if(q){if(this.callback&&typeof(this.callback)==="function"){this.callback()}this.cancel();return}while(o--){p=this.elements[o];n=p.update();if(n){p.done=true}}this.id=window.requestAnimationFrame(this.draw.bind(this,r))},cancel:function(){window.cancelAnimationFrame(this.id)},redraw:function(){this.cancel();this.elements.forEach(function(n){n.reset()});this.draw()}};function c(n,o,p){this.el=n;this.duration=o;this.easing=p;this.animationStart=null;this.animationStarted=false}c.prototype={constructor:c,update:function(){if(!this.animationStarted){this.animationStart=Date.now();this.animationStarted=true}var n=this.easing((Date.now()-this.animationStart)/this.duration);this.fill(n);return n>=1?true:false},fill:function(n){var o=Math.ceil(this.length*(1-n));this.el.style.strokeDashoffset=o<0?0:Math.abs(o)},complete:function(){this.fill(1)},reset:function(){this.done=false;this.animationStart=0;this.animationStarted=false;this.fill(0)}};function e(o,n,p){c.call(this,o,n,p);this.length=o.getTotalLength()}function d(n,o,p){c.call(this,n,o,p);this.length=j(n)}function h(n,o,p){c.call(this,n,o,p);this.length=l(n)}e.prototype=d.prototype=h.prototype=Object.create(c.prototype);function l(o){var u=0;var p,n,t,r;var q;var s=o.points.numberOfItems;for(q=1;q<s;q++){p=o.points.getItem(q-1).x;n=o.points.getItem(q).x;t=o.points.getItem(q-1).y;r=o.points.getItem(q).y;u+=Math.sqrt(Math.pow((p-n),2)+Math.pow((t-r),2))}return u}function j(n){var p=n.getAttribute("x1");var o=n.getAttribute("x2");var r=n.getAttribute("y1");var q=n.getAttribute("y2");return Math.sqrt(Math.pow((p-o),2)+Math.pow((r-q),2))}return i}));